<%- include('partials/header') %>
<%- include('partials/navbar') %>

<section class="packages-header">
  <div class="container">
    <h1>Adventure Packages</h1>
    <p>Discover your perfect adventure from our curated collection</p>
  </div>
</section>

<section class="packages-section section">
  <div class="container">
    <div class="filters-bar">
      <form id="filter-form" method="GET">
        <select name="type" onchange="this.form.submit()">
          <option value="">All Types</option>
          <option value="Trekking" <%= filters.type === 'Trekking' ? 'selected' : '' %>>Trekking</option>
          <option value="Water Sports" <%= filters.type === 'Water Sports' ? 'selected' : '' %>>Water Sports</option>
          <option value="Wildlife" <%= filters.type === 'Wildlife' ? 'selected' : '' %>>Wildlife</option>
          <option value="Camping" <%= filters.type === 'Camping' ? 'selected' : '' %>>Camping</option>
        </select>

        <select name="difficulty" onchange="this.form.submit()">
          <option value="">All Difficulties</option>
          <option value="Easy" <%= filters.difficulty === 'Easy' ? 'selected' : '' %>>Easy</option>
          <option value="Moderate" <%= filters.difficulty === 'Moderate' ? 'selected' : '' %>>Moderate</option>
          <option value="Challenging" <%= filters.difficulty === 'Challenging' ? 'selected' : '' %>>Challenging</option>
        </select>

        <input type="number" name="minPrice" placeholder="Min Price" value="<%= filters.minPrice || '' %>">
        <input type="number" name="maxPrice" placeholder="Max Price" value="<%= filters.maxPrice || '' %>">
        
        <button type="submit" class="btn-primary">Apply Filters</button>
        <a href="/packages" class="btn-secondary">Clear</a>
      </form>
    </div>

    <div class="package-grid">
      <% if (packages.length === 0) { %>
        <p class="no-results">No packages found matching your criteria.</p>
      <% } else { %>
        <% packages.forEach(package => { %>
          <div class="package-card">
            <div class="package-image" style="background-image: url('<%= package.imageUrl %>')"></div>
            <div class="package-content">
              <span class="package-type"><%= package.type %></span>
              <h3><%= package.title %></h3>
              <p class="package-location">üìç <%= package.location %></p>
              <p class="package-description"><%= package.description.substring(0, 100) %>...</p>
              <div class="package-meta">
                <span>‚≠ê <%= package.rating.toFixed(1) %> (<%= package.reviewCount %>)</span>
                <span>‚è±Ô∏è <%= package.duration %> days</span>
                <span class="difficulty <%= package.difficulty.toLowerCase() %>"><%= package.difficulty %></span>
              </div>
              <div class="package-footer">
                <div class="package-price">
                  <span class="price-label">From</span>
                  <span class="price-amount">$<%= package.price %></span>
                </div>
                <a href="/packages/<%= package._id %>" class="btn-primary">View Details</a>
              </div>
            </div>
          </div>
        <% }) %>
      <% } %>
    </div>
  </div>
</section>

<%- include('partials/footer') %>
